from Bio import SeqIO


genbank1 = '/Users/timolucas/Documents/teaching/gbi2020/9_assignment/sequence.gb-2.txt'
genbank2 = '/Users/timolucas/Documents/teaching/gbi2020/9_assignment/sequence.gb-3.txt'
genbank3 = '/Users/timolucas/Documents/teaching/gbi2020/9_assignment/sequence.gb-4.txt'
genbank4 = '/Users/timolucas/Documents/teaching/gbi2020/9_assignment/sequence.gb-5.txt'
genbank5 = '/Users/timolucas/Documents/teaching/gbi2020/9_assignment/sequence.gb-6.txt'

gene1 = "AAAATGGGATGTGTTTGCAGCAAGCAATTAGAAGGAAGAAGGCAAGAAGACATTTCGCTTCTTGCTTCTCAAACCTTTTGTAAGTTACGTCTACTTCAATCATCCACCACTTCCTCCTCCTATATATTATATTGCATGGAGAAAGAATATTATTACACGAGCTTGTAGATCAGATAACATCTAAATTGTTTTGGGTTTGCAGTTAGCGAGGCTGAGGTTGAAGTTTTGCATGGATTGTTCATCAAACTCACTTCTTGTCTTAGCAACGACAATCTTTTGACCAAAGTTAGAGTCCAAACTAATTTTTCTTCCACAATGTGAATAATTTTTTTTTGGTCAACAAAATGTGAATAATATAACATCTAAATTTTATACTAGCTAGTTATAGAAAAGTTGTGCTTTTGTCATGTCAAATTTGGTTGGCTTTTCCAGGAAAAATTTCAATTTATCTTGATCAAGAATACCAAAAAGCGCAGTCTTTCTGCAGAACGGGTAATTGAATTTGTTATATTAAGCGAAATAAATAAATAAACTTCGATTGATGTTGTTTCTCTGAAATATGCAGATTTTTGGATTATTCGATATGAGAAACGATGGGGCTATAGATTTTGGAGAGTTTGTACACACACTCAACATTTTTCACCCAAACTCATCACCAAGAGATAAGGCCATATGTATGCTTCATCACTTCTAATGTGTTTATTCATTTATTCCATGTTATTATTATTTTCTATATAGCTAGAGATCAATGTTATTAACTATAACCACAAATACATCTGATCACTTGTTTAAAATTAAACAGTTGCATTTAGATTATACGATACTCGTGAGACTGGATTCATTGAACCGGAGGAGGTACGTATGTAAACTTTGTCTCAAAAAAAAGAAAAAGTCATGATTAATTATATTTGACGGTTTTCCTCGACTTGGAGAAATCTATAGGTGAAAGAGATGATAATAGACGTTCTAGAGGAATCAGAACTTATGCTATCCGAGAGTATCATTGATTCTATCGTGTCTAAGGTGTGTATAACGCTTAAGTTTATGAGCTTGATTTAACATTATAGTGATTTTACTTACTATTTTTGTTTACTTATATTTGGCAAAGACATTTGAAGAGGCCGATTGGAAAAAAGATGGGATAATAGATTTGGAAGAATGGGAGAATTTTGTTGCCACCTATCCTTTGACACTAAAGAACATGACTATCCCTTTCTTGAAGTAATTCGTTTGTTTGTTTTTCCTAACCATTTTCTTAATATTCGCTGATAAATTGCATGTTTTAGATACATCTTTCGTTTTACAAAAAAAGTAATATATATACATCTTTCAAAAACAGCTTTTATATATGTGTGTTTATGCATATATTACTATTATCTTCTTTTATTTTATTTTTCTTGTTTTATAAATCGAGATAATTATTCTAAAATTAACTTTTATTGTACAGGGACATTCCGAGGATTTTCCCAACCTTTCTCCGGTAA"
cds1_1 = gene1[3:79]
cds1_2 = gene1[202:285]
cds1_3 = gene1[432:492]
cds1_4 = gene1[565:674]
cds1_5 = gene1[432:492]
cds1_6 = gene1[565:674]
cds1_7 = gene1[802:855]
cds1_8 = gene1[942:1023]
cds1_9 = gene1[1108:1221]
cds1_10 = gene1[1447:1484]

gene2="CTTTTGATGAACTATCCCTCTCCAAGGTTTGATGGATCAAGCTGGTCCAAGCTTCCTTCAGATCTTCTGAATATGGTTTTTGAACGTCTTGGGTTTGCAGATTTTCAACGAGCTAAATCCGTTTGTCCATCTTGGCTAGATGCTTCAAGACAATCAGCGTCAAAAAATCAGATCCCTTGGCTGATCATGTTTCCAGAAAAAGGTAAAGACTATTGTCTCTTGTTTAATTCTGAAGAAAAGGAGAAAGCCTATAGAATTAAAGATCTTGGTGTTGAATTCGCAAATAGTCATTGTTTGGCGATATATGGAAGTTGGCTCTTTATGCGAGATTCTAGATATAATCTCTATGTTATGAATCTATTTACTCGCGAGAGGATTAATTTTCCATCTGTGGAGTCACAATTTGAAATCGATGACGAATATGATGTTGAATATCCTGAAAGACACATCAATATTGACTTCCCTTTATTATGGATAGACGATATAACCAAACATTACGTGGTTATATGGTCAATCCAATACCGCCAATACCAATATCTAGTTTATTATAGGAAAGGAGATAATTGGTTGAAACATGCTACTTACTGTAGTTTTGATATGGTAGGCATTGTTGACATGGTATACAAAGATCATAAGATTTACTTGTATAGTACAACTAGTGATGTCAAAGTGTTGGAATTTTTTGGAGATATTCTTTTTGATAGGATTTTTTGGAGATATTCCGCGACAAATCTTTGAAACGCAAGTTAACTATGATGTGTTGGCTAATGGAGTACGCCGCGTTCGTCCAGAGCTTGGTAATGTGTTTCATATCAAGAATACACATCTTGTAGTCACAATGACCGGAGAAACCCTCAGAGTTGATAGCATAATAAGGAGTGATTCTGATGTTTGGTCCTTTTGCATCTACCAAATGGATTCATCAAATAGCAAGTGGGAGAAACTTACTTCTTTGGGAGATGAAGCAATACTCCTGGATCAAGGCATCACCGTGCTTGCCAACGCCATTGAAGGAGTTAATAGAAATTCAATATATTTTAGTGGTGTTCAATTTCAATATGGTTATGTTAGCAGTGAAAAGGATAT"
cds2_1 = gene2[6:738]
gene3="TCCCAATGATGACTTATTAAGATTAAAAATGTTAAAAGTAGTGACTGATATCTTTTGATGAAATTTTAGCTCTGAGGGAT"
cds3_1=gene3
gene4="AGTATCATCTCTACCGTCCGTTGACCGATCATTCCTTCTCATCCAACGACTCAGGATCCACGGCAGCTCTTCTTCCTTCCCTGAATCTTCTCCTTCTGCGTCTATTCTCTCCGGCGCAGATCCGTTGAAGTGTACGGTCTCTGGTGGATCTCTTGCTAAATGGATCACCGGGATTTCAGCTGGATCCGCCTTAGGGTTTCTCTATTGGTCCTCTGGTTCTTCTGATTCCATCTCTGGTTTGTTTGGTGGGAGTAATTTATTGTCCTTCGCTGATAGTTCAACGCCTTCTGTTTGTGGTGTAAAAGTCGGCGATCTGAAACCGAGATCGTTTATTCCGAAATTGTCGTTGCCTGGTTACAGCTCTGGATTCATCTTCGGAGATGCGTATAGAAGGAAGATCTTCTTCAATTACGAGAAACGTTTGAGATTACAAAGTCCTCCTGAAAAGGTTTTCGAGTACTTTGCATCTGTTCGAACAGATAAAGGAGAAATACTAATGAAACCGGCAGATTTGATGAGGGCAATTGTCCCCGTGTTTCCTCCATCAGAATCTCATCTAGTAAGAGAAGGATATTTGACTGGGGAGAGAAATCCTGGTGAACTTAGATGCTCTCCTTCCGAGTTCTTCATGCTCTTTGATGTTGATAATGATGGTCTTATATCCTTCAAAGAGTATATATTCTTTGTGACATTACTCAGCATTCCTGAATCAAGCTTCGCAGTGGCTTTCAAAATGTTTGATACTGACAACAACGGGTGAGTAGTCGTTCACATATGTAAATAGATAAATCATGCTTTTGGTAACTTTTTTTCTGGTCCGTATTCCCATATTGTGATCCTCCAAACGGACGGGTTGTGGGAATCAGTGGAGTCTCTTTTTGAGTTTACGCTGAATCATCTGGGAGATTGACAAAGAAGAGTTTAAGACAGTGATGAGTCTGATGCGATCTCAGCATAGACAAGGAGTTGGCCACAGAGATGGCCTTCGAACAGGGTTACATATGACCGGTTCTGTCGAGGATGGAGGATTGGTAGAATACTTCTTTGGGAAAGATGGCAGTCAAAAACTGAAACACGACAAATTCACTAAGTTTATGAAAGATCTAACTGAAGAGATGCTGAGGCTGGAGTTTGCACATTATGACTATAAACGAAGAGGAAGTATATCGGCCAAAGATTTTGCATTGTCGATGGTTGCAGCGGCTGATGCAAGCCATTTGAGCAAGCTGCTTGATAGAGTTGAGAGTCTGAGCGAACACCCGCATCTCCGGGACATGCGTATCTCACTGAAGGAATTCAAACAGTTTGATGAGCTACGTAGTAAACTTGGACCATTCTCTCTAGCGCTTTTTGCTTATGGCAAAGCTAATGGTTTACTTACAATGAAAGATTTCAAACGAGCCGCCTCTCAGAGAGAGGGACGTGGCACAGCCAATTGCAAAAGGATTGTCTCGGTACTTCTCAGATGGATGGAAGGGTTCTAAGAACTGTTCCTCATCGTGAAGACTCTTCTTCCTCTTTGGGGCTTACCGATGAAACTCGAAGACTATTTTTTGAGGCTCTTGGGTTCATACGAGTGAGCCCAGAGATTTTATGATTACTCCACGCTGGCATTGTAAGAAAGAAATCTGAATAAATCTGTGTATAGTTTGATCGACCTATGAACTTTTTTGTTTTGTTTTGTTAATGATAAATGGTAATTGCATAAAACAGAAGTCTCTGTTAAAGATTACACGGCTAAGAAATTGATACATATCTTTGTATAAAAAAAAAAAAAAAA"
cds4_1=gene4[932:1484]
gene5="GTTGAATCCTTGTTAATCTTTTTCTTCAATCTCTCGATCTGATCGTTATCGAAACCGCGCGATTCTAACCAAGTCCAGGTGACAAATCAGCTCTGCTAAAATACTCACAAAGTCTCGTGATCATATTTTGTGGATCACATCATTGTCTTATTTTTGGAATTGCTTATCCTCGCACTAGTTCACTGATTTGAGATCTGTGCAGTTAATTTTGTGCTCCATAGCGATTCCATGGCTTCTTTAATGTTATCTCTCGGTTCCACTTCTCTGTTACCGCGCGAGATTAACAAGGATAAGCTAAAGCTTGGAACTTCTGCTTCGAACCCGTTCCTAAAAGCAAAGTCTTTTAGCAGAGTGACTATGACGGTTGCAGTGAAGCCTTCTCGTTTCGAGGGTATAACTATGGCTCCACCAGACCCTATTCTTGGAGTCAGTGAAGCATTCAAAGCTGACACTAACGGGATGAAACTCAATCTTGGTGTTGGTGCTTATCGTACTGAGGAACTCCAGCCTTATGTGCTTAATGTTGTTAAAAAGGCGGAGAATTTGATGTTGGAGAGAGGAGATAACAAAGAGTATCTTCCAATTGAGGGGTTGGCAGCATTCAACAAGGCTACTGCTGAGTTGCTATTTGGAGCTGGTCATCCTGTTATTAAGGAACAAAGAGTAGCAACAATTCAGGGTCTTTCGGGAACAGGTTCACTGCGATTAGCAGCGGCTCTTATAGAGCGTTATTTCCCTGGAGCAAAAGTTGTGATCTCATCACCAACCTGGGGTAATCACAAGAATATCTTCAATGATGCCAAAGTTCCGTGGTCCGAATACCGCTACTATGATCCAAAAACAATTGGTTTGGATTTTGAGGGAATGATAGCAGATATAAAGGAAGCTCCAGAAGGATCCTTCATCTTGCTTCACGGATGTGCTCACAACCCAACTGGAATTGACCCAACACCAGAACAGTGGGTAAAAATTGCTGATGTCATTCAGGAAAAGAACCATATCCCATTTTTCGATGTTGCATACCAGGGCTTTGCTAGTGGAAGCCTTGATGAAGATGCAGCATCTGTGAGATTATTTGCTGAGCGGGGAATGGAGTTTTTTGTTGCTCAGTCATATAGTAAAAATTTAGGTTTGTATGCAGAAAGAATTGGGGCAATCAATGTCGTGTGCTCCTCAGCTGATGCTGCTACAAGGGTCAAGAGCCAGTTGAAAAGGATTGCTCGGCCTATGTACTCGAATCCACCAGTTCATGGGGCGAGAATCGTGGCCAATGTAGTGGGTGATGTAACTATGTTCAGTGAATGGAAAGCAGAGATGGAAATGATGGCAGGAAGAATAAAGACGGTTAGACAAGAGCTGTATGATAGCCTCGTTTCAAAAGACAAGAGCGGGAAGGACTGGTCCTTCATTCTGAAGCAAATTGGCATGTTCTCTTTCACCGGCCTAAACAAAGCTCAGAGCGATAACATGACGGACAAATGGCATGTGTATATGACTAAAGACGGGAGGATATCATTGGCCGGATTATCTCTGGCCAAATGCGAGTATCTTGCTGATGCGATCATCGACTCATACCATAACGTAAGCTGAGCTTCCATCTCAGTAGATGACAATAAGAAACAGTTTTATATACCCTTTTTAGCTTCTTCTTGATCTTTGATTGAAACCAGATGGCTAAATTAATAAGCTAGCATCACACTATGATTGCTAGACAATTTTCAAGGAAACTTTTGATTTGATCGTGTTTGACAGGCCTTGTTGTATTGGGAGACTCCCATCGAGAAAAAAAAAAAAAAA"
cds5_1=gene5[228:1590]


intron_1 = gene1.replace(cds1_1,"").replace(cds1_2,"").replace(cds1_3,"").replace(cds1_4,"").replace(cds1_5,"").replace(cds1_6,"").replace(cds1_7,"").replace(cds1_8,"").replace(cds1_9,"").replace(cds1_10,"")
intron_2 = gene2.replace(cds2_1,"")
intron_3 = gene3.replace(cds3_1,"")
intron_4 = gene4.replace(cds4_1,"")
intron_5 = gene5.replace(cds5_1,"")

#number of introns
num_intron_bases=len(intron_1)+ len(intron_2) + len(intron_3)+ len(intron_4) + len(intron_5)
print("Intron bases:" + str(num_intron_bases))
num_exon_bases=(len(gene1) + len(gene2) + len(gene3) + len(gene4) + len(gene5)) - num_intron_bases
print("Exon bases:" + str(num_exon_bases))
for gene in [genbank1,genbank2,genbank3,genbank4,genbank5]:
    for rec in SeqIO.parse(gene, "genbank"):
        if rec.features:
            for feature in rec.features:
                if feature.type == "gene":
                    print(feature.location)
                    #print(feature.qualifiers["protein_id"])
                    print(feature.location.extract(rec).seq)

                if feature.type == "CDS":
                    print(feature.location)
                    #print(feature.qualifiers["protein_id"])
                    print(feature.location.extract(rec).seq)



